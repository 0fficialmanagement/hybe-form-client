(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function s(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(i){if(i.ep)return;i.ep=!0;const o=s(i);fetch(i.href,o)}})();class K{constructor(){this.activeModals=new Map,this.activeTimers=new Map}initialize(n){const s=document.getElementById(n);if(!s)return console.error(`Modal ${n} not found`),null;try{const a=new bootstrap.Modal(s);return this.activeModals.set(n,a),s.addEventListener("hidden.bs.modal",()=>{this.cleanup(n)},{once:!0}),a}catch(a){return console.error(`Failed to initialize modal "${n}": ${a.message}`),null}}show(n,s={}){const a=this.activeModals.get(n)||this.initialize(n);a&&(s.countdown&&this.setupCountdown(n,s.countdown),a.show())}hide(n){const s=this.activeModals.get(n);s&&s.hide()}setupCountdown(n,{duration:s,elementId:a,onComplete:i}){const o=document.getElementById(a);if(!o){console.error(`Countdown element "${a}" not found`);return}let r=s;o.textContent=r;const B=setInterval(()=>{if(r--,o.textContent=r,r<=0&&(this.cleanup(n),this.hide(n),typeof i=="function"))try{i()}catch(p){console.error(`Error in onComplete callback: ${p.message}`)}},1e3);this.activeTimers.set(n,B)}cleanup(n){const s=this.activeTimers.get(n);s&&(clearInterval(s),this.activeTimers.delete(n))}}const N=new K;document.addEventListener("DOMContentLoaded",()=>{typeof AOS<"u"&&AOS.init({duration:800,once:!0});const f=document.getElementById("subscription-form"),n=document.getElementById("form-message"),s=document.getElementById("referral-code"),a=document.getElementById("full-name"),i=document.getElementById("email"),o=document.getElementById("phone"),r=document.getElementById("dob"),B=document.getElementById("gender"),p=document.getElementById("branch"),g=document.getElementById("group"),y=document.getElementById("artist"),E=document.getElementById("payment-type"),S=document.getElementById("installment-options");document.getElementById("payment-methods");const Y=document.getElementById("privacy-policy"),P=document.getElementById("subscription-agreement"),h=document.getElementById("submit-btn"),b=h.querySelector(".btn-text"),O=h.querySelector(".spinner-border"),w=document.querySelector(".progress-bar"),M=document.getElementById("country-select");document.getElementById("country"),document.getElementById("currency"),document.getElementById("language");const J=document.getElementById("permit-id"),C=document.getElementById("submission-id"),H=document.getElementById("digital-currency-home-btn");N.show("onboardingModal");const T=[{name:"BigHit Music",groups:["BTS","TXT"]},{name:"PLEDIS Entertainment",groups:["SEVENTEEN","fromis_9"]},{name:"BELIFT LAB",groups:["ENHYPEN","ILLIT"]},{name:"KOZ Entertainment",groups:["ZICO"]},{name:"ADOR",groups:["NewJeans"]},{name:"HYBE Labels Japan",groups:["&TEAM"]}];T.forEach(t=>{const e=document.createElement("option");e.value=t.name,e.textContent=t.name,p.appendChild(e)}),p.addEventListener("change",()=>{const t=T.find(e=>e.name===p.value);g.innerHTML='<option value="" disabled selected>Select a Group</option>',y.innerHTML='<option value="" disabled selected>Select an Artist</option>',t&&t.groups.forEach(e=>{const u=document.createElement("option");u.value=e,u.textContent=e,g.appendChild(u)}),v()}),g.addEventListener("change",()=>{y.innerHTML='<option value="" disabled selected>Select an Artist</option>';const t=g.value,e={BTS:["RM","Jin","SUGA","j-hope","Jimin","V","Jung Kook"],TXT:["SOOBIN","YEONJUN","BEOMGYU","TAEHYUN","HUENINGKAI"],SEVENTEEN:["S.COUPS","JEONGHAN","JOSHUA","JUN","HOSHI","WONWOO","WOOZI","THE 8","MINGYU","DK","SEUNGKWAN","VERNON","DINO"],fromis_9:["LEE SAEROM","SONG HAYOUNG","PARK JIWON","ROH JISUN","LEE SEOYEON","LEE CHAEYOUNG","LEE NAGYUNG","BAEK JIHEON"],ENHYPEN:["JUNGWON","HEESEUNG","JAY","JAKE","SUNGHOON","SUNOO","NI-KI"],ILLIT:["YUNAH","MINJU","MOKA","WONHEE","IROHA"],ZICO:["ZICO"],NewJeans:["MINJI","HANNI","DANIELLE","HAERIN","HYEIN"],"&TEAM":["K","FUMA","NICHOLAS","EJ","YUMA","JO","HARUA","TAKI","MAKI"]};e[t]&&e[t].forEach(u=>{const m=document.createElement("option");m.value=u,m.textContent=u,y.appendChild(m)}),v()});function v(){let e=0;s.value&&e++,a.value&&e++,i.value&&e++,o.value&&e++,document.getElementById("address-line1").value&&e++,document.getElementById("city").value&&e++,document.getElementById("state").value&&e++,document.getElementById("postal-code").value&&e++,M.value&&e++,r.value&&e++,B.value&&e++,p.value&&e++,g.value&&e++,y.value&&e++,E.value&&e++,document.querySelector('input[name="contact-method"]:checked')&&e++;const u=e/16*100;w.style.width=`${u}%`,w.setAttribute("aria-valuenow",u)}E&&S&&E.addEventListener("change",()=>{E.value==="Installment"?(S.classList.remove("d-none"),document.getElementById("installment-plan").required=!0):(S.classList.add("d-none"),document.getElementById("installment-plan").required=!1),document.querySelectorAll('input[name="payment-method"]').forEach(t=>{t.required=!0}),v()}),H&&H.addEventListener("click",()=>{N.hide("digitalCurrencySuccessModal"),window.location.href="https://hybecorp.com"});function D(){const t=Date.now(),e=Math.floor(Math.random()*1e4);return`HYBE-FP-${t}-${e}`}function c(t,e="info"){n&&(n.className=`mt-3 text-center alert alert-${e} alert-dismissible fade show`,n.textContent=t,n.classList.remove("d-none"),setTimeout(()=>{n.classList.add("d-none")},7e3))}function l(){h&&O&&b&&(h.disabled=!1,O.classList.add("d-none"),b.classList.remove("d-none"))}[s,a,i,o,document.getElementById("address-line1"),document.getElementById("address-line2"),document.getElementById("city"),document.getElementById("state"),document.getElementById("postal-code"),M,r,B,p,g,y,E].forEach(t=>{t&&t.addEventListener("input",v)}),document.querySelectorAll('input[name="contact-method"]').forEach(t=>{t.addEventListener("change",v)}),document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(t=>{new bootstrap.Tooltip(t)});let d;function L(t){t?(o.classList.remove("is-invalid"),o.classList.add("is-valid")):(o.classList.remove("is-valid"),o.classList.add("is-invalid"))}function G(t){fetch("https://ipapi.co/json").then(e=>e.json()).then(e=>t(e.country_code)).catch(()=>t("US"))}window.intlTelInput&&o&&G(t=>{d=window.intlTelInput(o,{separateDialCode:!0,initialCountry:t,nationalMode:!1,formatOnDisplay:!0,autoPlaceholder:"polite",utilsScript:"https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/18.1.1/js/utils.js"}),o.addEventListener("input",()=>{if(d){const e=d.isValidNumber();L(e),e&&(o.value=d.getNumber())}}),o.addEventListener("countrychange",()=>{if(d){const e=d.isValidNumber();L(e)}})});const $=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;f&&f.addEventListener("submit",async t=>{t.preventDefault(),h&&O&&b&&(h.disabled=!0,O.classList.remove("d-none"),b.classList.add("d-none")),n&&n.classList.add("d-none");try{if(!f.checkValidity()){f.classList.add("was-validated"),c("Please fill out all required fields correctly.","danger"),l();return}const e=document.querySelectorAll('input[name="contact-method"]');if(!Array.from(e).some(I=>I.checked)){c("Please select at least one preferred contact method.","danger"),l();return}if(s.value!=="HYBE2025"){c("Invalid referral code. Use HYBE2025.","danger"),l();return}if(!$.test(i.value)){c("Invalid email address.","danger"),l();return}let m=!1;if(d&&typeof d.isValidNumber=="function"?(m=d.isValidNumber(),L(m)):(m=/^\+?[0-9\s\-()]{7,20}$/.test(o.value),L(m)),!m){c("Invalid phone number.","danger"),l();return}d&&typeof d.getNumber=="function"&&(o.value=d.getNumber());const A=new Date(r.value);if(isNaN(A)||r.value!==A.toISOString().split("T")[0]){c("Invalid date of birth. Use YYYY-MM-DD format.","danger"),l();return}if(new Date().getFullYear()-A.getFullYear()<13){c("You must be at least 13 years old to subscribe.","danger"),l();return}if(!Y.checked){c("You must agree to the Privacy Policy.","danger"),l();return}if(!P.checked){c("You must agree to complete the subscription.","danger"),l();return}J.value=D(),C.value=`SUB-${Date.now()}`,N.show("validationModal",{countdown:{duration:5,elementId:"countdown",onComplete:()=>{const I=f.querySelector('input[name="payment-method"]:checked');if(!I){c("Please select a payment method.","danger"),l();return}I.value==="Card Payment"?N.show("paymentModal",{countdown:{duration:5,elementId:"payment-countdown",onComplete:()=>{const U=E.value;U==="Full Payment"?window.location.href="https://buy.stripe.com/14AfZh1LD4eL9Kx0972ZO04":U==="Installment"&&(window.location.href="https://buy.stripe.com/3cIfZhgGxdPlaOBaNL2ZO06")}}}):I.value==="Digital Currency"?(N.show("digitalCurrencySuccessModal"),l()):(c("Selected payment method is not supported.","danger"),l()),console.log(`Subscription submitted: ${C.value}, Artist: ${y.value}, Payment: ${E.value}`)}}})}catch(e){c(`Submission failed: ${e.message}`,"danger"),l()}})});
